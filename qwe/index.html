<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<title>test</title>
	<style>
		html,body{width: 100vw;height: 100vh;display: flex;justify-content: center;align-items: center;background: #333;}
		canvas{background: #fff;}
	</style>
</head>
<body>
	<canvas id="canvas" width="1200" height="675"></canvas>
	<script>
		var FPS= 60;
		var images;
		var loadImage= function (sources, callback){
			var nb = 0;
			var loaded = 0;
			var imgs = {};
			for(var i in sources){
				nb++;
				imgs[i] = new Image();
				imgs[i].src = sources[i];
				imgs[i].onload = function(){
					loaded++;
					if(loaded == nb){
						callback(imgs);
					}
				}
			}
		}
		// var canvas= document.getElementById("canvas");
		// var ctx= canvas.getContext("2d");
		var a= new Slide().timeline;
		function Slide (){
			this.canvas= document.getElementById("canvas");
			this.ctx= canvas.getContext("2d");
			this.W= canvas.width;
			this.H= canvas.height;
			this.S= 150;
			this.L= 300;
			this.cnt= [0, 0, 0];
			this.Slide_cnt= 0;
			this.timeline=[
				0,
				-0.1,
				-0.4,
				-0.8,
				-1.5,
				-2.3,
				-3.3,
				-4.5,
				-5.9,
				-7.5,
				-9.4,
				-11.4,
				-13.7,
				-16.3,
				-19,
				-22.1,
				-25.3,
				-28.9,
				-32.7,
				-36.8,
				-41.3,
				-46,
				-51,
				-56.4,
				-62.1,
				-68.1,
				-74.6,
				-81.4,
				-88.6,
				-96.2,
				-104.2,
				-112.7,
				-121.7,
				-131.2,
				-141.1,
				-151.7,
				-162.7,
				-174.4,
				-186.7,
				-199.7,
				-213.4,
				-227.8,
				-243,
				-259,
				-275.9,
				-293.8,
				-312.6,
				-332.5,
				-353.6,
				-376,
				-399.6,
				-424.8,
				-451.5,
				-479.9,
				-510.3,
				-542.7,
				-577.3,
				-614.6,
				-654.6,
				-697.8,
				-744.5,
				-795.3,
				-850.5,
				-910.8,
				-976.9,
				-1049.5,
				-1129,
				-1216,
				-1310.2,
				-1410.7,
				-1515.1,
				-1620.1,
				-1722.2,
				-1818.5,
				-1907.2,
				-1987.7,
				-2060.3,
				-2125.5,
				-2184.2,
				-2237.1,
				-2285,
				-2328.4,
				-2367.9,
				-2404,
				-2437,
				-2467.3,
				-2495.1,
				-2520.8,
				-2544.5,
				-2566.4,
				-2586.6,
				-2605.4,
				-2622.8,
				-2638.9,
				-2653.9,
				-2667.7,
				-2680.6,
				-2692.5,
				-2703.6,
				-2713.8,
				-2723.2,
				-2732,
				-2740,
				-2747.4,
				-2754.2,
				-2760.4,
				-2766.1,
				-2771.2,
				-2775.8,
				-2780,
				-2783.7,
				-2787,
				-2789.9,
				-2792.4,
				-2794.5,
				-2796.2,
				-2797.6,
				-2798.7,
				-2799.5,
				-2799.9,
				-2800,
				-2800.1,
				-2800.4,
				-2800.8,
				-2801.5,
				-2802.3,
				-2803.3,
				-2804.5,
				-2805.9,
				-2807.5,
				-2809.3,
				-2811.4,
				-2813.7,
				-2816.2,
				-2819,
				-2822,
				-2825.3,
				-2828.8,
				-2832.6,
				-2836.7,
				-2841.1,
				-2845.8,
				-2850.8,
				-2856.2,
				-2861.8,
				-2867.9,
				-2874.3,
				-2881,
				-2888.2,
				-2895.8,
				-2903.8,
				-2912.3,
				-2921.2,
				-2930.6,
				-2940.5,
				-2951,
				-2962,
				-2973.7,
				-2985.9,
				-2998.8,
				-3012.4,
				-3026.7,
				-3041.8,
				-3057.7,
				-3074.5,
				-3092.3,
				-3111,
				-3130.8,
				-3151.7,
				-3173.9,
				-3197.4,
				-3222.4,
				-3248.9,
				-3277.1,
				-3307.2,
				-3339.3,
				-3373.6,
				-3410.5,
				-3450.2,
				-3492.9,
				-3539.2,
				-3589.3,
				-3643.9,
				-3703.5,
				-3768.8,
				-3840.5,
				-3919.1,
				-4005,
				-4098.4,
				-4198.2,
				-4302.3,
				-4407.6,
				-4510.4,
				-4607.7,
				-4697.5,
				-4779.2,
				-4852.8,
				-4919,
				-4978.5,
				-5032.1,
				-5080.6,
				-5124.5,
				-5164.5,
				-5200.9,
				-5234.3,
				-5264.9,
				-5293,
				-5318.9,
				-5342.8,
				-5364.9,
				-5385.3,
				-5404.2,
				-5421.7,
				-5437.9,
				-5453,
				-5467,
				-5479.9,
				-5491.9,
				-5503,
				-5513.3,
				-5522.8,
				-5531.6,
				-5539.7,
				-5547.1,
				-5553.9,
				-5560.2,
				-5565.8,
				-5571,
				-5575.7,
				-5579.9,
				-5583.6,
				-5586.9,
				-5589.8,
				-5592.3,
				-5594.4,
				-5596.2,
				-5597.6,
				-5598.7,
				-5599.4,
			]
		}
		Slide.prototype.LimitCnt= function (){
			var m= this.Slide_cnt*120;
			// console.log(m);
			return this.cnt[0]<m && this.cnt[1]<m && this.cnt[2]<m;

		}
		Slide.prototype.draw= function (){
			for(var i=0; i<9; i++){// cliping, drawing
				var j= i%3;
				
				this.ctx.save();
			    this.ctx.beginPath();
			    switch(j){
			    	case 0:
					    this.ctx.moveTo(0, 0);
					    this.ctx.lineTo(this.W, 0);
					    this.ctx.lineTo(this.W, this.S);
					    this.ctx.lineTo(0, this.L);
			    		break;
			    	case 1:
			    		this.ctx.moveTo(0, this.L);
					    this.ctx.lineTo(this.W, this.S);
					    this.ctx.lineTo(this.W, this.L+200);
					    this.ctx.lineTo(0, this.S+500);
			    		break;
			    	case 2:
			    		this.ctx.moveTo(0, this.S+500);
					    this.ctx.lineTo(this.W, this.L+200);
					    this.ctx.lineTo(this.W, this.H);
					    this.ctx.lineTo(0, this.H);
			    		break;
			    }
			    this.ctx.closePath();
			    this.ctx.clip();
			    this.ctx.drawImage(images, this.timeline[this.cnt[j]]/2800*this.W, 0);
			    this.ctx.restore();
			}
			var self = this;
			if(this.cnt[2]<this.Slide_cnt*120)
			requestAnimationFrame(function(){
				self.draw();
			});
		}
		Slide.prototype.update= function (){
			var self= this;

			this.cnt[0]= this.cnt[0]<this.Slide_cnt*120? this.cnt[0]+1: this.cnt[0];
			setTimeout(function (){
				self.cnt[1]= self.cnt[1]<self.Slide_cnt*120? self.cnt[1]+1: self.cnt[1];
				setTimeout(function (){
					self.cnt[2]= self.cnt[2]<self.Slide_cnt*120? self.cnt[2]+1: self.cnt[2];
					console.log(self.cnt[2]);
				}, 100)
			}, 100)
			if(this.cnt[2]<this.Slide_cnt*120){
				setTimeout(function (){
					self.update();
				}, 1000/FPS);
			}
		}
		
		window.onload= _ =>{
			var src= ["file:///C:/Users/digitaldigm/Desktop/2/images/index_1_180918.jpg", "file:///C:/Users/digitaldigm/Desktop/2/images/index_2_180918.jpg", "file:///C:/Users/digitaldigm/Desktop/2/images/index_3_180918.jpg"];
			var start= function (){
				var slide= new Slide();
				slide.Slide_cnt++;
				console.log(slide.LimitCnt());
				console.log(slide.Slide_cnt)
				slide.draw();//draw image
				slide.update();//update image
			}
			var getWidth= function (imgs){
				var width= 0;
				for(var i in imgs){
					width+= imgs[i].width;
				}
				return width;
			}
			loadImage(src, function (imgs){
				var Image_width= getWidth(imgs);
				var FullImage= document.createElement("canvas");
				var FullImage_ctx= FullImage.getContext('2d');
				FullImage.width= Image_width;
				FullImage.height= 675;
				FullImage_ctx.drawImage(imgs[0], 0, 0, 1200, 675);
				FullImage_ctx.drawImage(imgs[1], 1200, 0, 1200, 675);
				images= FullImage;
				start();
			});
		}
	</script>
</body>
</html>