---
title: "React CSS-in-JS ì‹œìŠ¤í…œ ë§Œë“¤ê¸°"
date: "2022-06-01"
preview: "styled-components ê°™ì€ React CSS-in-JS ì‹œìŠ¤í…œì„ ë§Œë“œëŠ” ë‚´ìš©ì„ ë‹¤ë£¹ë‹ˆë‹¤."
tag: ["javascript", "vanilla", "css-in-js"]
slug: 'css-in-js'
---

import HelloWorld from '../components/blog/css-in-js/step1/HelloWorld.tsx';
import App2 from '../components/blog/css-in-js/step2/App';
import App3 from '../components/blog/css-in-js/step3/App';

<TableOfContents />

ì´ í¬ìŠ¤íŠ¸ëŠ” styled-componentsë¥¼ ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§ í•˜ë©´ì„œ ì–»ì€ ì§€ì‹ì„ ì´ìš©í•´ ê°„ë‹¨í•œ CSS-in-JS ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ë³´ëŠ” ë‚´ìš©ì´ë‹¤.

# 1. CSS-in-JS?
CSS-in-JSë€ ìŠ¤íƒ€ì¼ë§ì— `Javascript`ë¥¼ ì‚¬ìš©í•˜ëŠ” `CSS` ë°©ë²•ë¡ ì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ `CSS`ë§Œ ì‚¬ìš©í•´ë„ ì˜ë§Œ ìŠ¤íƒ€ì¼ë§ì´ ë í…ë° ì™œ ìŠ¤íƒ€ì¼ë§ì— `Javascript`ë¥¼ ì‚¬ìš©í• ê¹Œ?

ì›¹ ë¬¸ì„œì˜ ì‚¼ìœ„ì¼ì²´ì¸ `HTML`, `CSS`, `Javascript`ëŠ” ê¹”ë”í•œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ë¥¼ ì œê³µí•œë‹¤.<br />`HTML`ì€ ì›¹ ë¬¸ì„œì˜ êµ¬ì¡°ë¥¼ ë§Œë“¤ê³  `CSS`ëŠ” UI ìŠ¤íƒ€ì¼ë§ì„ ë‹´ë‹¹í•˜ê³  `Javascript`ëŠ” ë™ì ì¸ ê¸°ëŠ¥ë“¤ì„ ë‹´ë‹¹í–ˆë‹¤. ê³¼ê±° ì½˜í…ì¸ ì˜ ëŒ€ë¶€ë¶„ì€ ì •ì ì´ì˜€ê¸° ë•Œë¬¸ì— ë³„ë‹¤ë¥¸ ì–´ë ¤ì›€ ì—†ì´ ìŠ¤íƒ€ì¼ë§ ì‘ì—…ì„ í•  ìˆ˜ ìˆì—ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ `Javascript`ê°€ ì—„ì²­ë‚œ ì†ë„ë¡œ ë°œì „í•˜ë©´ì„œ ì™„ì „íˆ ìƒˆë¡œìš´ ê°œë°œ ìƒíƒœê³„(SPA)ê°€ ë„ë˜í–ˆë‹¤.

<figure><img src="/css-in-js/spa.jpeg" alt="SPA EVERYWHERE" /></figure>

SPAì—ì„œëŠ” ë”ìš± ë³µì¡í•˜ê³  ë™ì ì¸ ì½˜í…ì¸ , ê¸°ëŠ¥, êµ¬ì¡°ë“¤ì´ ì¶”ê°€ëë‹¤.<br />ì ì  ì›¹ì˜ ê·œëª¨ê°€ ì»¤ì§€ê³  ì»´í¬ë„ŒíŠ¸í™” ë˜ë©´ì„œ CSS ì‘ì—…ì— [ì—¬ëŸ¬ê°€ì§€ ë¬¸ì œë“¤](https://speakerdeck.com/vjeux/react-css-in-js?slide=2)ì´ ë°œìƒí–ˆê³ , í•´ê²°ë²•ìœ¼ë¡œ CSS-in-JSê°€ ë“±ì¥í•œ ê²ƒì´ë‹¤.

<figure>
  <img src="/css-in-js/css-problem.png" />
  <figcaption>React: CSS in JS, vjeux (November 08, 2014)</figcaption>
</figure>

ì´ì œ ì§ì ‘ React CSS-in-JS ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ ë³´ì.





# 2. Tagged templates

ë§Œë“¤ ì‹œìŠ¤í…œì€ styled-componentsë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ë¯€ë¡œ ë¨¼ì € Tagged templatesì— ëŒ€í•´ ì´í•´ê°€ í•„ìš”í•˜ë‹¤.

í…œí”Œë¦¿ ë¦¬í„°ëŸ´(\`)ì˜ ê¸°ëŠ¥ì¤‘ í•˜ë‚˜ì¸ Tagged templatesëŠ” í…œí”Œë¦¿ ë¦¬í„°ëŸ´ì„ íŒŒì‹±í•˜ì—¬ í•¨ìˆ˜ì˜ ì¸ìë¡œ ë„˜ê¸¸ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

```javascript
fn`some string here` === fn(['some string here']); // ğŸŸ¢ true
```



ì²«ë²ˆì§¸ ì¸ìë¡œ ë¬¸ìì—´ ë°°ì—´, ë‚˜ë¨¸ì§€ ì¸ìë“¤ë¡œ ì‚½ì…ëœ í‘œí˜„ì‹ì„ ë°›ìœ¼ë©°, ì¸ìë¡œ í…œí”Œë¦¿ ë¦¬í„°ëŸ´ì„ ì§ì ‘ ë„˜ê¸°ëŠ” ê²ƒê³¼ ë‹¬ë¦¬ í‘œí˜„ì‹ ê°’ë“¤ì˜ íƒ€ì…ì„ ìœ ì§€í•œì±„ ì¸ìë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

```javascript
const aVar = 'good';

fn`this is a ${aVar} day` === fn(['this is a ', ' day'], aVar); // ğŸŸ¢ true

fn`${true} === "true"` === fn([' === "true"'], true); // ğŸ”´ false
fn`${true} === "true"` === fn(['', ' === "true"'], true); // ğŸŸ¢ true

fn`${true} === ${false}` === fn(['', ' === ', ''], true, false); // ğŸŸ¢ true
```

Tagged templatesë¡œ ë°›ì€ ì¸ìë¥¼ ë‹¤ì‹œ ì›ë˜ string í˜•íƒœë¡œ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ë³´ì.



```javascript
const getStyle = (styleStringArray, ...interpolations) => {
  const result = [styleStringArray[0]];

  for (let i = 0, len = interpolations.length; i < len; i ++) {
    result.push(interpolations[i], styleStringArray[i + 1]);
  }

  return result.join('');
}


const color = '#f00';

getStyle`
  display: flex;
  color: ${color};
` === `
  display: flex;
  color: ${color};
` // ğŸŸ¢ true
``` 

- L5: ë°°ì—´ì— [ë¬¸ìì—´, í‘œí˜„ì‹, ë¬¸ìì—´, í‘œí˜„ì‹...] ìˆœì„œë¡œ ê°’ì„ ì •ë ¬í•´ì¤€ë‹¤.
- L8: ì •ë ¬ëœ ë°°ì—´ì„ stringìœ¼ë¡œ í•©ì¹˜ë©´ ì›ë³¸ í…œí”Œë¦¿ ë¦¬í„°ëŸ´ ê°’ì´ ë‚˜ì˜¨ë‹¤.

ìœ„ ì½”ë“œëŠ” styled í•¨ìˆ˜ì—ì„œ ì‚¬ìš©ë  ì˜ˆì •ì´ë‹¤.





# 3. styled

Tagged templatesë¥¼ ê¸°ë°˜ìœ¼ë¡œ ```styled``` í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ë³´ì. í•¨ìˆ˜ëŠ” ì•„ë˜ ìˆœì„œë¡œ ì‘ë™í•  ê²ƒì´ë‹¤.

1. íƒ€ê²Ÿ íƒœê·¸ or ì»´í¬ë„ŒíŠ¸ë¥¼ ë°›ëŠ”ë‹¤.
2. Tagged templatesë¡œ cssë¥¼ ë°›ëŠ”ë‹¤.
3. css styleì´ ì ìš©ëœ ì»´í¬ë„ŒíŠ¸ë¥¼ return í•œë‹¤.

ë¨¼ì € styleì„ ì ìš©í•˜ì§€ ì•Šê³  ì»´í¬ë„ŒíŠ¸ë¥¼ return í•˜ëŠ” ë¶€ë¶„ê¹Œì§€ ì½”ë“œë¥¼ êµ¬ì„±í•´ë³´ì.

```jsx
function styled(Tag) {
  // Tagged templatesë¡œ styleì„ ë°›ëŠ” í•¨ìˆ˜ë¥¼ return í•œë‹¤
}

const domElements = ['a', 'abbr', 'address', 'area', ...]; // ì „ì²´ íƒœê·¸ ë¦¬ìŠ¤íŠ¸

domElements.forEach(domElement => {
  styled[domElement] = styled(domElement); // styled.div í˜•ì‹ ëŒ€ì‘
});
```

- L2: ```styled``` í•¨ìˆ˜ëŠ” Tagged templatesë¡œ styleì„ ë°›ëŠ” í•¨ìˆ˜ë¥¼ return í•´ì•¼ í•œë‹¤.
- L8: HTML íƒœê·¸ì˜ ê²½ìš° ```styled('div')```ê°€ ì•„ë‹ˆë¼ ```styled.div``` í˜•ì‹ì„ ì£¼ë¡œ ì‚¬ìš©í•˜ë¯€ë¡œ, ì „ì²´ íƒœê·¸ë“¤ì„ ì†ì„±ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ì¶”ê°€í•´ì¤€ë‹¤.

```jsx
function styled(Tag) {
  return function templateFunction(styleStringArray, ...interpolations) {
    // Tagged templatesë¥¼ ì„¤ëª…í• ë•Œ ë§Œë“  getStyleì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤.
    const style = getStyle(styleStringArray, ...interpolations);

    // ì»´í¬ë„ŒíŠ¸ë¥¼ return í•œë‹¤
  }
}

const domElements = ['a', 'abbr', 'address', 'area', ...];

domElements.forEach(domElement => {
  styled[domElement] = styled(domElement);
});
```

- L4: Tagged templatesë¡œ ë°›ì€ íŒŒë¼ë¯¸í„°ëŠ” ```getStyle``` í•¨ìˆ˜ë¡œ ì‹¤ì œ styleê³¼ ë™ì¼í•˜ê²Œ ë³€ê²½ì‹œì¼œ ì¤€ë‹¤.
- L6: ```templateFunction``` ì—ì„œ ì»´í¬ë„ŒíŠ¸ë¥¼ return í•´ì£¼ë©´ ê¸°ë³¸ì ì¸ ```styled``` í•¨ìˆ˜ëŠ” ë§ˆë¬´ë¦¬ ëœë‹¤.

```jsx
function styled(Tag) {
  return function templateFunction(styleStringArray, ...interpolations) {
    const style = getStyle(styleStringArray, ...interpolations);

    return function WrappedStyledComponent({ children, ...props }) {
      return (
        <Tag {...props}>
          <p>style: {style}</p>
          {children}
        </Tag>
      );
    }
  }
}

const domElements = ['a', 'abbr', 'address', 'area', ...]; // ì „ì²´ íƒœê·¸ ë¦¬ìŠ¤íŠ¸

domElements.forEach(domElement => {
  styled[domElement] = styled(domElement); // styled.div í˜•ì‹ ëŒ€ì‘
});
```

- L7: ì»´í¬ë„ŒíŠ¸ì˜ propsë“¤ì€ íƒ€ê²Ÿ ì»´í¬ë„ŒíŠ¸ì— ê·¸ëŒ€ë¡œ ë„˜ê²¨ì¤€ë‹¤.
- L8: styleì€ ì ìš©í•˜ì§€ëŠ” ì•Šê³  ì¼ë‹¨ í™”ë©´ì— í‘œì‹œí•˜ë„ë¡ í•œë‹¤.

ì „ì²´ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

**styled.jsx**

```jsx
const getStyle = (styleStringArray, ...interpolations) => {
  const result = [styleStringArray[0]];

  for (let i = 0, len = interpolations.length; i < len; i++) {
    result.push(interpolations[i], styleStringArray[i + 1]);
  }

  return result.join('');
};

function styled(Tag) {
  return function templateFunction(styleStringArray, ...interpolations) {
    const style = getStyle(styleStringArray, ...interpolations);

    return function WrappedStyledComponent({ children, ...props }) {
      return (
        <Tag {...props}>
          <p>style: {style}</p>
          {children}
        </Tag>
      );
    }
  }
}

const domElements = ['a', 'abbr', 'address', 'area', ...]; // ì „ì²´ íƒœê·¸ ë¦¬ìŠ¤íŠ¸

domElements.forEach(domElement => {
  styled[domElement] = styled(domElement);
});

export default styled;
```

ì´ì œ ì‹¤ì œ Appì— ì ìš©í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì.

**App.jsx**

```jsx
import styled from './styled';

const color = '#f00';

const Container = styled.div`
  display: flex;
  justify-content: space-between;
  color: ${color};
`;

const World = styled.span`
  color: #000;
  font-weight: bold;
`;

function App() {
  return (
    <Container>
      Hello,
      <World>World!</World>
    </Container>
  );
}

export default App;
```

<HelloWorld />

"Hello, World!" í…ìŠ¤íŠ¸ì™€ í•¨ê»˜ ì ìš©í•  styleì´ ì˜ í‘œì‹œë˜ëŠ”ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.

----------

ì´ì œ styleì„ ì»´í¬ë„ŒíŠ¸ì— ì§ì ‘ ì ìš©ì„ í•´ë³´ì. ì ìš©ì„ í•˜ë ¤ë©´ css styleì„ ì¶”ê°€í•  ```<style>``` Elementì™€ styleì´ ì ìš©ë  classNameì´ í•„ìš”í•˜ë‹¤.

styleì„ ê´€ë¦¬í•  ```Sheet class```ë¥¼ ë§Œë“¤ì–´ ë³´ì.

```js
class Sheet {
  constructor() {
    document.head.appendChild(this.ele = document.createElement('style'));
  }

  // classNameì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ê°€ í•„ìš”í•˜ë‹¤.
}
```

- L3: ìƒì„±ì ë‚´ì—ì„œ headì— ```<style>``` Elementë¥¼ ìƒì„±í•´ì¤€ë‹¤.
- L3: ìƒì„±í•œ ```<style>``` ElementëŠ” ```ele``` ì†ì„±ìœ¼ë¡œ ì €ì¥í•œë‹¤.

classNameì€ styleì— ë”°ë¼ ìœ ë‹ˆí¬í•˜ê²Œ ìƒì„±í•´ì•¼ í•˜ë¯€ë¡œ hash í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

```js
const hash = (s) =>
  `hash${s.split('').reduce((num, t) => {
    num = (num << 5) - num + t.charCodeAt(0);

    return num & num;
  }, 0)}`;
```

- hash í•¨ìˆ˜ë¡œ ìŠ¤íƒ€ì¼ì„ ë„˜ê¸°ë©´ `hash${hashedStyle}` í˜•ì‹ì˜ ë¬¸ìì—´ì„ return í•œë‹¤. [(ì°¸ì¡°í•œ stackoverflow)](https://stackoverflow.com/a/15710692)

ì´ì œ hash í•¨ìˆ˜ì™€ ```<style>``` Elementë¥¼ ì´ìš©í•´ className ìƒì„± í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

```js
const hash = (s) =>
  `hash${s.split('').reduce((num, t) => {
    num = (num << 5) - num + t.charCodeAt(0);

    return num & num;
  }, 0)}`;

class Sheet {
  constructor() {
    document.head.appendChild(this.ele = document.createElement('style'));
  }

  generateClassName(style) {
    const styledClassName = hash(style);

    const rule = `.${styledClassName} { ${style} }`;

    if (!this.ele.innerText.includes(rule)) {
      this.ele.appendChild(document.createTextNode(rule));
    }

    return styledClassName;
  }
}
```

- L14: hashë¡œ classNameì„ ìƒì„±í•œë‹¤.
- L16: ```selector { style }``` í˜•ì‹ì˜ css codeë¥¼ ìƒì„±í•œë‹¤.
- L18: ì´ë¯¸ styleì´ ì¡´ì¬í•˜ëŠ”ì§€ ì²´í¬í•˜ê³  ì—†ëŠ” ruleì´ë¼ë©´ ì¶”ê°€í•´ì¤€ë‹¤.
- L22: classëª…ì„ returní•œë‹¤.

ì „ì²´ Sheet ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

**sheet.js**

```js
const hash = (s) =>
  `hash${s.split('').reduce((num, t) => {
    num = (num << 5) - num + t.charCodeAt(0);

    return num & num;
  }, 0)}`;

class Sheet {
  constructor() {
    document.head.appendChild(this.ele = document.createElement('style'));
  }

  generateClassName(style) {
    const styledClassName = hash(style);

    const rule = `.${styledClassName} { ${style} }`;

    !this.ele.innerText.includes(rule) && this.ele.appendChild(document.createTextNode(rule));

    return styledClassName;
  }
}

export default Sheet;
```

ì™„ì„±ëœ classë¥¼ ```styled``` í•¨ìˆ˜ì— ì ìš©í•´ë³´ì.

**styled.jsx**

```jsx
import Sheet from './sheet';

const sheet = new Sheet();

// getStyle function...

function styled(Tag) {
  return function templateFunction(styleStringArray, ...interpolations) {
    const style = getStyle(styleStringArray, ...interpolations);

    const styledClassName = sheet.generateClassName(style);

    return function WrappedStyledComponent({ children, ...props }) {
      return (
        <Tag {...props} className={styledClassName.concat(props.className ? ` ${props.className}` : '')}>
          {children}
        </Tag>
      );
    };
  };
}

const domElements = ['a', 'abbr', 'address', 'area', ...];

domElements.forEach((domElement) => {
  styled[domElement] = styled(domElement);
});

export default styled;
```

- L11: styleì„ ì´ìš©í•´ classNameì„ ìƒì„±í•´ì¤€ë‹¤.
- L15: classNameì„ Tagì— ì¶”ê°€í•´ì£¼ê³ , ê¸°ì¡´ì— í™”ë©´ì— í‘œì‹œí•˜ë˜ styleì€ ì œê±°í•œë‹¤.

classNameì„ ë„˜ê¸´í›„ Demoë¥¼ í™•ì¸í•´ë³´ë©´ styleì´ ì ìš©ëœê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<App2 />

----------

ë§ˆì§€ë§‰ìœ¼ë¡œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë¥¼ extend í•´ì„œ ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ ë³´ì.

**App.jsx**

```jsx
// ...

const Container = styled.div`
  display: flex;
  justify-content: space-between;
  color: ${color};
`;

const Container2 = styled(Container)`
  justify-content: center;
  color: #666;
`;

// const World...

function App() {
  return (
    <Container2>
      Hello,
      <World>World!</World>
    </Container2>
  );
}

export default App;
```

<App3 />

- L9: ```Container```ë¥¼ ```styled()```ë¡œ ê°ì‹¸ ```Container2```ë¥¼ ë§Œë“¤ì—ˆë‹¤.
- L10 ~ 11: ê¸°ì¡´ì˜ ```justify-content```, ```color``` styleì„ override í–ˆë‹¤.

Demoë¥¼ í†µí•´ ```justify-content```, ```color``` ì†ì„±ì´ ì˜ override ëœê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.



# 4. ë§ˆë¬´ë¦¬

ê°„ë‹¨í•œ CSS-in-JS ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ ë³´ì•˜ë‹¤. í¬ìŠ¤íŠ¸ë¥¼ ì¬ë°Œê²Œ ë´¤ë‹¤ë©´ í…œí”Œë¦¿ ë¦¬í„°ëŸ´ë¡œ ë„˜ê¸´ functionì— ëŒ€í•œ ì²˜ë¦¬ ë¶€ë¶„ì„ ì§ì ‘ êµ¬í˜„í•´ë´ë„ ì¢‹ì„ ê²ƒ ê°™ë‹¤.

```jsx
const Container = styled.div`
  display: flex;
  justify-content: space-between;
  color:  ${props => props.primary ? 'white' : 'palevioletred'};
`;
```

í¬ìŠ¤íŠ¸ì—ëŠ” ì•ˆë‚˜ì˜¨ ì‹¤ì œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì˜ ê¸°ëŠ¥ê³¼ ìµœì í™”ì— ëŒ€í•´ ê¶ê¸ˆí•˜ë‹¤ë©´ [ê³µì‹ ë¬¸ì„œ](https://styled-components.com/docs)ì™€ [github ì˜¤í”ˆ ì†ŒìŠ¤](https://github.com/styled-components/styled-components)ë¥¼ ì°¸ê³ í•˜ì.

ì´ í¬ìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©ëœ ì½”ë“œëŠ” [ì—¬ê¸°](https://github.com/pyjun01/css-in-js)ì„œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.





# ì°¸ê³ 

- https://levelup.gitconnected.com/a-brief-history-of-css-in-js-how-we-got-here-and-where-were-going-ea6261c19f04
- https://speakerdeck.com/vjeux/react-css-in-js?slide=2
- https://developer.mozilla.org/en-US/docs/Web/Javascript/Reference/Template_literals
